!function(window,angular){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&angular.isDefined(obj);i++){var key=keys[i];obj=null!==obj?obj[key]:void 0}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var PROTOCOL_AND_DOMAIN_REGEX=/^https?:\/\/[^\/]*/,provider=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$log","$q","$timeout",function($http,$log,$q,$timeout){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method),numericTimeout=action.timeout,cancellable=angular.isDefined(action.cancellable)?action.cancellable:options&&angular.isDefined(options.cancellable)?options.cancellable:provider.defaults.cancellable;numericTimeout&&!angular.isNumber(numericTimeout)&&($log.debug("ngResource:\n  Only numeric values are allowed as `timeout`.\n  Promises are not supported in $resource, because the same value would be used for multiple requests. If you are looking for a way to cancel requests, you should use the `cancellable` option."),delete action.timeout,numericTimeout=null),Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var timeoutDeferred,numericTimeoutPromise,isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||void 0;forEach(action,function(value,key){switch(key){default:httpConfig[key]=copy(value);break;case"params":case"isArray":case"interceptor":case"cancellable":}}),!isInstanceCall&&cancellable&&(timeoutDeferred=$q.defer(),httpConfig.timeout=timeoutDeferred.promise,numericTimeout&&(numericTimeoutPromise=$timeout(timeoutDeferred.resolve,numericTimeout))),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2} (Request: {3} {4})",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object",httpConfig.method,httpConfig.url);if(action.isArray)value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)});else{var promise=value.$promise;shallowClearAndCopy(data,value),value.$promise=promise}}return response.resource=value,response},function(response){return(error||noop)(response),$q.reject(response)});return promise["finally"](function(){value.$resolved=!0,!isInstanceCall&&cancellable&&(value.$cancelRequest=angular.noop,$timeout.cancel(numericTimeoutPromise),timeoutDeferred=numericTimeoutPromise=httpConfig.timeout=null)}),promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,cancellable&&(value.$cancelRequest=timeoutDeferred.resolve),value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,protocolAndDomain="",urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]={isQueryParamValue:new RegExp("\\?.*=:"+param+"(?:\\W|$)").test(url)})}),url=url.replace(/\\:/g,":"),url=url.replace(PROTOCOL_AND_DOMAIN_REGEX,function(match){return protocolAndDomain=match,""}),params=params||{},forEach(self.urlParams,function(paramInfo,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=paramInfo.isQueryParamValue?encodeUriQuery(val,!0):encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=protocolAndDomain+url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var DEFAULT_ACTIONS,buildCachedResourceClass,readArrayCache,readCache,writeCache;DEFAULT_ACTIONS={get:{method:"GET"},query:{method:"GET",isArray:!0},save:{method:"POST"},remove:{method:"DELETE"},"delete":{method:"DELETE"}},readArrayCache=require("./read_array_cache"),readCache=require("./read_cache"),writeCache=require("./write_cache"),module.exports=buildCachedResourceClass=function($resource,$timeout,$q,providerParams,args){var $key,$log,Cache,CachedResource,Resource,ResourceCacheArrayEntry,ResourceCacheEntry,ResourceWriteQueue,actionConfig,actionName,actions,arg,boundParams,handler,isPermissibleBoundValue,method,param,paramDefault,paramDefaults,url;for($log=providerParams.$log,ResourceCacheEntry=require("./resource_cache_entry")(providerParams),ResourceCacheArrayEntry=require("./resource_cache_array_entry")(providerParams),ResourceWriteQueue=require("./resource_write_queue")(providerParams,$q),Cache=require("./cache")(providerParams),$key=args.shift(),url=args.shift();args.length;)arg=args.pop(),angular.isObject(arg[Object.keys(arg)[0]])?actions=arg:paramDefaults=arg;actions=angular.extend({},DEFAULT_ACTIONS,actions),null==paramDefaults&&(paramDefaults={}),boundParams={};for(param in paramDefaults)paramDefault=paramDefaults[param],"@"===paramDefault[0]&&(boundParams[paramDefault.substr(1)]=param);Resource=$resource.call(null,url,paramDefaults,actions),isPermissibleBoundValue=function(value){return angular.isDate(value)||angular.isNumber(value)||angular.isString(value)},CachedResource=function(){function CachedResource(attrs){angular.extend(this,attrs)}return CachedResource.prototype.$cache=!0,CachedResource.prototype.toJSON=function(){var data;return data=angular.extend({},this),delete data.$promise,delete data.$httpPromise,data},CachedResource.prototype.$params=function(){var attribute,params;params={};for(attribute in boundParams)param=boundParams[attribute],isPermissibleBoundValue(this[attribute])&&(params[param]=this[attribute]);return params},CachedResource.prototype.$$addToCache=function(dirty){var entry;return null==dirty&&(dirty=!1),entry=new ResourceCacheEntry($key,this.$params()),entry.set(this,dirty),this},CachedResource.$clearCache=function(_arg){var cacheArrayEntry,cacheKeys,clearChildren,clearPendingWrites,entries,exceptFor,isArray,key,params,queue,translateEntriesToCacheKeys,translateParamsArrayToCacheKeys,translateParamsArrayToEntries,where,_ref,_ref1;return _ref=null!=_arg?_arg:{},where=_ref.where,exceptFor=_ref.exceptFor,clearPendingWrites=_ref.clearPendingWrites,isArray=_ref.isArray,clearChildren=_ref.clearChildren,null==where&&(where=null),null==exceptFor&&(exceptFor=null),null==clearPendingWrites&&(clearPendingWrites=!1),null==isArray&&(isArray=!1),null==clearChildren&&(clearChildren=!1),where&&exceptFor?$log.error("Using where and exceptFor arguments at once in $clearCache() method is forbidden!"):(cacheKeys=[],translateParamsArrayToEntries=function(entries){return entries||(entries=[]),angular.isArray(entries)||(entries=[entries]),entries.map(function(entry){return new CachedResource(entry).$params()})},translateEntriesToCacheKeys=function(params_objects){return params_objects.map(function(params){return new ResourceCacheEntry($key,params).fullCacheKey()})},translateParamsArrayToCacheKeys=function(entries){return translateEntriesToCacheKeys(translateParamsArrayToEntries(entries))},(exceptFor||where)&&(isArray?(cacheArrayEntry=new ResourceCacheArrayEntry($key,exceptFor||where).load(),cacheKeys.push(cacheArrayEntry.fullCacheKey()),cacheArrayEntry.value&&(exceptFor&&!clearChildren||where&&clearChildren)&&(entries=function(){var _i,_len,_ref1,_results;for(_ref1=cacheArrayEntry.value,_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)params=_ref1[_i],_results.push(params);return _results}(),entries&&(cacheKeys=cacheKeys.concat(translateEntriesToCacheKeys(entries))))):cacheKeys=translateParamsArrayToCacheKeys(where||exceptFor)),clearPendingWrites||where?clearPendingWrites&&where&&$log.debug("TODO if clearPendingWrites && where"):(_ref1=CachedResource.$writes,queue=_ref1.queue,key=_ref1.key,cacheKeys.push(key),entries=queue.map(function(resource){return resource.resourceParams}),cacheKeys=cacheKeys.concat(translateEntriesToCacheKeys(entries))),where?Cache.clear({key:$key,where:cacheKeys}):Cache.clear({key:$key,exceptFor:cacheKeys}))},CachedResource.$addToCache=function(attrs,dirty){return new CachedResource(attrs).$$addToCache(dirty)},CachedResource.$addArrayToCache=function(attrs,instances,dirty){return null==dirty&&(dirty=!1),instances=instances.map(function(instance){return new CachedResource(instance)}),new ResourceCacheArrayEntry($key,attrs).addInstances(instances,dirty)},CachedResource.$resource=Resource,CachedResource.$key=$key,CachedResource}(),CachedResource.$writes=new ResourceWriteQueue(CachedResource,$timeout);for(actionName in actions)actionConfig=actions[actionName],method=actionConfig.method.toUpperCase(),actionConfig.cache!==!1?(handler="GET"===method&&actionConfig.isArray?readArrayCache($q,providerParams,actionName,CachedResource,actionConfig):"GET"===method?readCache($q,providerParams,actionName,CachedResource,actionConfig):"POST"===method||"PUT"===method||"DELETE"===method||"PATCH"===method?writeCache($q,providerParams,actionName,CachedResource,actionConfig):void 0,CachedResource[actionName]=handler,"GET"!==method&&(CachedResource.prototype["$"+actionName]=handler)):(CachedResource[actionName]=Resource[actionName],CachedResource.prototype["$"+actionName]=Resource.prototype["$"+actionName]);return CachedResource}},{"./cache":2,"./read_array_cache":7,"./read_cache":8,"./resource_cache_array_entry":9,"./resource_cache_entry":10,"./resource_write_queue":11,"./write_cache":12}],2:[function(require,module,exports){var Cache,localStorage;localStorage=window.localStorage,Cache=function(){function Cache(_arg){this.$log=_arg.$log,this.localStoragePrefix=_arg.localStoragePrefix}return Cache.prototype.memoryCache={},Cache.prototype.getItem=function(key,fallbackValue){var item,out;return key=this._buildKey(key),item=this.memoryCache[key],null==item&&(item=localStorage.getItem(key)),out=null!=item?angular.fromJson(item):fallbackValue,this.$log.debug("CACHE GET: "+key,out),out},Cache.prototype.setItem=function(key,value){var e,stringValue;key=this._buildKey(key),stringValue=angular.toJson(value);try{localStorage.setItem(key,stringValue),null!=this.memoryCache[key]&&delete this.memoryCache[key]}catch(_error){e=_error,this.$log.error("Failed to write to localStorage.",{error:e,key:key,value:stringValue}),this.memoryCache[key]=stringValue}return this.$log.debug("CACHE PUT: "+key,angular.fromJson(angular.toJson(value))),value},Cache.prototype.clear=function(_arg){var cacheKey,cacheKeys,exceptFor,exception,i,key,skipKey,where,_i,_j,_k,_l,_len,_len1,_len2,_ref,_ref1,_results,_results1;if(_ref=null!=_arg?_arg:{},key=_ref.key,exceptFor=_ref.exceptFor,where=_ref.where,where&&exceptFor)return this.$log.error("Using where and exceptFor arguments at once in clear() method is forbidden!");if(exceptFor){for(null==exceptFor&&(exceptFor=[]),cacheKeys=[],i=_i=0,_ref1=localStorage.length;_ref1>=0?_ref1>_i:_i>_ref1;i=_ref1>=0?++_i:--_i)if(cacheKey=localStorage.key(i),this._cacheKeyHasPrefix(cacheKey,key)){for(skipKey=!1,_j=0,_len=exceptFor.length;_len>_j;_j++)if(exception=exceptFor[_j],this._cacheKeyHasPrefix(cacheKey,exception)){skipKey=!0;break}skipKey||cacheKeys.push(cacheKey)}for(_results=[],_k=0,_len1=cacheKeys.length;_len1>_k;_k++)cacheKey=cacheKeys[_k],_results.push(localStorage.removeItem(cacheKey));return _results}for(_results1=[],_l=0,_len2=where.length;_len2>_l;_l++)cacheKey=where[_l],_results1.push(localStorage.removeItem(this._buildKey(cacheKey)));return _results1},Cache.prototype._buildKey=function(key){return""+this.localStoragePrefix+key},Cache.prototype._cacheKeyHasPrefix=function(cacheKey,prefix){var index,nextChar;return null==prefix?0===cacheKey.indexOf(this.localStoragePrefix):(prefix=this._buildKey(prefix),index=cacheKey.indexOf(prefix),nextChar=cacheKey[prefix.length],0===index&&(null==nextChar||"?"===nextChar||"/"===nextChar))},Cache}(),module.exports=function(providerParams){return new Cache(providerParams)}},{}],3:[function(require,module,exports){var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};module.exports=function(providerParams){var Cache,CachedResourceManager,buildCachedResourceClass;return buildCachedResourceClass=require("./build_cached_resource_class"),Cache=require("./cache")(providerParams),CachedResourceManager=function(){function CachedResourceManager($resource,$timeout,$q){this.byKey={},this.build=angular.bind(this,buildCachedResourceClass,$resource,$timeout,$q,providerParams)}return CachedResourceManager.prototype.keys=function(){return Object.keys(this.byKey)},CachedResourceManager.prototype.add=function(){var CachedResource,args;return args=Array.prototype.slice.call(arguments),CachedResource=this.build(args),this.byKey[CachedResource.$key]=CachedResource,CachedResource.$writes.flush(),CachedResource},CachedResourceManager.prototype.flushQueues=function(){var CachedResource,key,_ref,_results;_ref=this.byKey,_results=[];for(key in _ref)CachedResource=_ref[key],_results.push(CachedResource.$writes.flush());return _results},CachedResourceManager.prototype.clearCache=function(_arg){var CachedResource,clearPendingWrites,exceptFor,key,_ref,_ref1,_results;_ref=null!=_arg?_arg:{},exceptFor=_ref.exceptFor,clearPendingWrites=_ref.clearPendingWrites,null==exceptFor&&(exceptFor=[]),_ref1=this.byKey,_results=[];for(key in _ref1)CachedResource=_ref1[key],__indexOf.call(exceptFor,key)<0&&_results.push(CachedResource.$clearCache({clearPendingWrites:clearPendingWrites}));return _results},CachedResourceManager.prototype.clearUndefined=function(){return Cache.clear({exceptFor:this.keys()})},CachedResourceManager}()}},{"./build_cached_resource_class":1,"./cache":2}],4:[function(require,module,exports){var $cachedResourceFactory,$cachedResourceProvider,app,debugMode,localStoragePrefix,resourceManagerListener,__slice=[].slice;resourceManagerListener=null,debugMode=!1,localStoragePrefix=null,"undefined"!=typeof module&&null!==module&&(module.exports=app=angular.module("ngCachedResource",["ngResource"])),app.provider("$cachedResource",$cachedResourceProvider=function(){function $cachedResourceProvider(){this.$get=$cachedResourceFactory,localStoragePrefix="cachedResource://"}return $cachedResourceProvider.prototype.setDebugMode=function(newSetting){return null==newSetting&&(newSetting=!0),debugMode=newSetting},$cachedResourceProvider.prototype.setLocalStoragePrefix=function(prefix){return localStoragePrefix=prefix},$cachedResourceProvider}()),$cachedResourceFactory=["$resource","$timeout","$q","$log",function($resource,$timeout,$q,$log){var $cachedResource,CachedResourceManager,bindLogFunction,fn,providerParams,resourceManager,_i,_len,_ref;for(bindLogFunction=function(logFunction){return function(){var message;return message=1<=arguments.length?__slice.call(arguments,0):[],message.unshift("ngCachedResource"),$log[logFunction].apply($log,message)}},providerParams={localStoragePrefix:localStoragePrefix,$log:{debug:debugMode?bindLogFunction("debug"):function(){},error:bindLogFunction("error")}},CachedResourceManager=require("./cached_resource_manager")(providerParams),resourceManager=new CachedResourceManager($resource,$timeout,$q),resourceManagerListener&&document.removeEventListener("online",resourceManagerListener),resourceManagerListener=function(event){return resourceManager.flushQueues()},document.addEventListener("online",resourceManagerListener),$cachedResource=function(){return resourceManager.add.apply(resourceManager,arguments)},_ref=["clearCache","clearUndefined"],_i=0,_len=_ref.length;_len>_i;_i++)fn=_ref[_i],$cachedResource[fn]=angular.bind(resourceManager,resourceManager[fn]);return $cachedResource}]},{"./cached_resource_manager":3}],5:[function(require,module,exports){var modifyObjectInPlace;module.exports=modifyObjectInPlace=function(oldObject,newObject,cachedObject){var key,localChange,localChanges,_i,_j,_len,_len1,_ref,_ref1;for(_ref=Object.keys(oldObject),_i=0,_len=_ref.length;_len>_i;_i++)key=_ref[_i],"$"!==key[0]&&(localChange=cachedObject&&null==cachedObject[key],null!=newObject[key]||localChange||delete oldObject[key]);for(_ref1=Object.keys(newObject),_j=0,_len1=_ref1.length;_len1>_j;_j++)key=_ref1[_j],"$"!==key[0]&&(angular.isObject(oldObject[key])&&angular.isObject(newObject[key])?modifyObjectInPlace(oldObject[key],newObject[key],null!=cachedObject?cachedObject[key]:void 0):(localChanges=cachedObject&&!angular.equals(oldObject[key],cachedObject[key]),angular.equals(oldObject[key],newObject[key])||localChanges||(oldObject[key]=newObject[key])));return null!=newObject.length?oldObject.length=newObject.length:void 0}},{}],6:[function(require,module,exports){var processReadArgs;module.exports=processReadArgs=function($q,args){var deferred,error,params,success;return args=Array.prototype.slice.call(args),params=angular.isObject(args[0])?args.shift():{},success=args[0],error=args[1],deferred=$q.defer(),angular.isFunction(success)&&deferred.promise.then(success),angular.isFunction(error)&&deferred.promise["catch"](error),{params:params,deferred:deferred}}},{}],7:[function(require,module,exports){var modifyObjectInPlace,processReadArgs,readArrayCache,__slice=[].slice;processReadArgs=require("./process_read_args"),modifyObjectInPlace=require("./modify_object_in_place"),module.exports=readArrayCache=function($q,providerParams,name,CachedResource,actionConfig){var ResourceCacheArrayEntry,ResourceCacheEntry,first;return ResourceCacheEntry=require("./resource_cache_entry")(providerParams),ResourceCacheArrayEntry=require("./resource_cache_array_entry")(providerParams),first=function(array,params){var found,item,itemParams,_i,_len;for(found=null,_i=0,_len=array.length;_len>_i;_i++)if(item=array[_i],itemParams=item.$params(),Object.keys(params).every(function(key){return itemParams[key]===params[key]})){found=item;break}return found},function(){var arrayInstance,cacheArrayEntry,cacheDeferred,cacheInstanceEntry,cacheInstanceParams,httpDeferred,params,readHttp,_i,_len,_ref,_ref1;if(_ref=processReadArgs($q,arguments),params=_ref.params,cacheDeferred=_ref.deferred,httpDeferred=$q.defer(),arrayInstance=new Array,arrayInstance.$promise=cacheDeferred.promise,arrayInstance.$httpPromise=httpDeferred.promise,cacheArrayEntry=new ResourceCacheArrayEntry(CachedResource.$key,params).load(),arrayInstance.$push=function(resourceInstance){return arrayInstance.push(resourceInstance),cacheArrayEntry.addInstances([resourceInstance],!1,{append:!0})},arrayInstance.$httpPromise.then(function(instances){return cacheArrayEntry.addInstances(instances,!1)}),readHttp=function(){var resource;return resource=CachedResource.$resource[name](params),resource.$promise.then(function(response){var newArrayInstance;return newArrayInstance=new Array,response.map(function(resourceInstance){var existingInstance;return resourceInstance=new CachedResource(resourceInstance),existingInstance=first(arrayInstance,resourceInstance.$params()),existingInstance?(modifyObjectInPlace(existingInstance,resourceInstance),newArrayInstance.push(existingInstance)):newArrayInstance.push(resourceInstance)}),arrayInstance.splice.apply(arrayInstance,[0,arrayInstance.length].concat(__slice.call(newArrayInstance))),cacheArrayEntry.value||cacheDeferred.resolve(arrayInstance),httpDeferred.resolve(arrayInstance)}),resource.$promise["catch"](function(error){return cacheArrayEntry.value||cacheDeferred.reject(error),httpDeferred.reject(error)})},actionConfig.cacheOnly||CachedResource.$writes.flush(readHttp),cacheArrayEntry.value){for(_ref1=cacheArrayEntry.value,_i=0,_len=_ref1.length;_len>_i;_i++)cacheInstanceParams=_ref1[_i],cacheInstanceEntry=new ResourceCacheEntry(CachedResource.$key,cacheInstanceParams).load(),arrayInstance.push(new CachedResource(cacheInstanceEntry.value));cacheDeferred.resolve(arrayInstance)}else actionConfig.cacheOnly&&cacheDeferred.reject(new Error("Cache value does not exist for params",params));return arrayInstance}}},{"./modify_object_in_place":5,"./process_read_args":6,"./resource_cache_array_entry":9,"./resource_cache_entry":10}],8:[function(require,module,exports){var modifyObjectInPlace,processReadArgs,readCache;processReadArgs=require("./process_read_args"),modifyObjectInPlace=require("./modify_object_in_place"),module.exports=readCache=function($q,providerParams,name,CachedResource,actionConfig){var ResourceCacheEntry;return ResourceCacheEntry=require("./resource_cache_entry")(providerParams),function(){var cacheDeferred,cacheEntry,httpDeferred,instance,params,readHttp,_ref;return _ref=processReadArgs($q,arguments),params=_ref.params,cacheDeferred=_ref.deferred,httpDeferred=$q.defer(),instance=new CachedResource({$promise:cacheDeferred.promise,$httpPromise:httpDeferred.promise}),cacheEntry=new ResourceCacheEntry(CachedResource.$key,params).load(),readHttp=function(){var resource;return resource=CachedResource.$resource[name].call(CachedResource.$resource,params),resource.$promise.then(function(httpResponse){return modifyObjectInPlace(instance,httpResponse),cacheEntry.value||cacheDeferred.resolve(instance),httpDeferred.resolve(instance),cacheEntry.dirty&&providerParams.$log.error("unexpectedly setting a clean entry (load) over a dirty entry (pending write)"),cacheEntry.set(httpResponse,!1)}),resource.$promise["catch"](function(error){return cacheEntry.value||cacheDeferred.reject(error),httpDeferred.reject(error)})},cacheEntry.dirty?CachedResource.$writes.processResource(params,readHttp):actionConfig.cacheOnly||readHttp(),cacheEntry.value?(angular.extend(instance,cacheEntry.value),cacheDeferred.resolve(instance)):actionConfig.cacheOnly&&cacheDeferred.reject(new Error("Cache value does not exist for params",params)),instance}}},{"./modify_object_in_place":5,"./process_read_args":6,"./resource_cache_entry":10}],9:[function(require,module,exports){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};module.exports=function(providerParams){var $log,ResourceCacheArrayEntry,ResourceCacheEntry;return $log=providerParams.$log,ResourceCacheEntry=require("./resource_cache_entry")(providerParams),ResourceCacheArrayEntry=function(_super){function ResourceCacheArrayEntry(){return ResourceCacheArrayEntry.__super__.constructor.apply(this,arguments)}return __extends(ResourceCacheArrayEntry,_super),ResourceCacheArrayEntry.prototype.defaultValue=[],ResourceCacheArrayEntry.prototype.cacheKeyPrefix=function(){return""+this.key+"/array"},ResourceCacheArrayEntry.prototype.addInstances=function(instances,dirty,options){var cacheArrayReferences,cacheInstanceEntry,cacheInstanceParams,instance,_i,_len;for(null==options&&(options={append:!1}),cacheArrayReferences=options.append?this.value:[],null==cacheArrayReferences&&(cacheArrayReferences=[]),_i=0,_len=instances.length;_len>_i;_i++)instance=instances[_i],cacheInstanceParams=instance.$params(),0===Object.keys(cacheInstanceParams).length?$log.error("'"+this.key+"' instance doesn't have any boundParams. Please, make sure you specified them in your resource's initialization, f.e. `{id: \"@id\"}`, or it won't be cached."):(cacheArrayReferences.push(cacheInstanceParams),cacheInstanceEntry=new ResourceCacheEntry(this.key,cacheInstanceParams).load(),options.append&&null!=cacheInstanceEntry.value||cacheInstanceEntry.set(instance,dirty));return this.set(cacheArrayReferences,dirty)},ResourceCacheArrayEntry}(ResourceCacheEntry)}},{"./resource_cache_entry":10}],10:[function(require,module,exports){module.exports=function(providerParams){var $log,Cache,ResourceCacheEntry;return $log=providerParams.$log,Cache=require("./cache")(providerParams),ResourceCacheEntry=function(){function ResourceCacheEntry(key,params){var param,paramKeys;this.key=key,paramKeys=angular.isObject(params)?Object.keys(params).sort():[],paramKeys.length?this.cacheKeyParams="?"+function(){var _i,_len,_results;for(_results=[],_i=0,_len=paramKeys.length;_len>_i;_i++)param=paramKeys[_i],_results.push(""+param+"="+params[param]);return _results}().join("&"):this.cacheKeyParams=""}return ResourceCacheEntry.prototype.defaultValue={},ResourceCacheEntry.prototype.cacheKeyPrefix=function(){return this.key},ResourceCacheEntry.prototype.fullCacheKey=function(){return this.cacheKeyPrefix()+this.cacheKeyParams},ResourceCacheEntry.prototype.load=function(){var _ref;return _ref=Cache.getItem(this.fullCacheKey(),this.defaultValue),this.value=_ref.value,this.dirty=_ref.dirty,this},ResourceCacheEntry.prototype.set=function(value,dirty){return this.value=value,this.dirty=dirty,this._update()},ResourceCacheEntry.prototype._update=function(){return Cache.setItem(this.fullCacheKey(),{value:this.value,dirty:this.dirty})},ResourceCacheEntry}()}},{"./cache":2}],11:[function(require,module,exports){var CACHE_RETRY_TIMEOUT;CACHE_RETRY_TIMEOUT=6e4,module.exports=function(providerParams,$q){var $log,Cache,ResourceCacheEntry,ResourceWriteQueue,flushQueueDeferreds,resetDeferred,resolveDeferred;return $log=providerParams.$log,ResourceCacheEntry=require("./resource_cache_entry")(providerParams),Cache=require("./cache")(providerParams),flushQueueDeferreds={},resetDeferred=function(queue){var deferred;return deferred=$q.defer(),flushQueueDeferreds[queue.key]=deferred,queue.promise=deferred.promise,deferred},resolveDeferred=function(queue){return flushQueueDeferreds[queue.key].resolve()},ResourceWriteQueue=function(){function ResourceWriteQueue(CachedResource,$timeout){var write,_i,_len,_ref;for(this.CachedResource=CachedResource,this.$timeout=$timeout,this.key=""+this.CachedResource.$key+"/write",this.queue=Cache.getItem(this.key,[]),_ref=this.queue,_i=0,_len=_ref.length;_len>_i;_i++)write=_ref[_i],write.busy=!1;resetDeferred(this),0===this.queue.length&&resolveDeferred(this)}return ResourceWriteQueue.prototype.logStatusOfRequest=function(status,action,params,data){return $log.debug(""+action+" for "+this.key+" "+angular.toJson(params)+" "+status+" (queue length: "+this.queue.length+")",data)},ResourceWriteQueue.prototype.enqueue=function(params,resourceData,action,deferred){var resourceParams,write,_ref,_ref1;return 0===this.queue.length&&resetDeferred(this),resourceParams=angular.isArray(resourceData)?resourceData.map(function(resource){return resource.$params()}):resourceData.$params(),write=this.findWrite({params:params,action:action}),null==write?(this.queue.push({params:params,resourceParams:resourceParams,action:action,deferred:deferred}),this._update()):(null!=(_ref=write.deferred)&&_ref.promise.then(function(response){return deferred.resolve(response)}),null!=(_ref1=write.deferred)&&_ref1.promise["catch"](function(error){return deferred.reject(error)})),this.logStatusOfRequest("enqueued",action,params,resourceData)},ResourceWriteQueue.prototype.findWrite=function(_arg){var action,params,write,_i,_len,_ref;for(action=_arg.action,params=_arg.params,_ref=this.queue,_i=0,_len=_ref.length;_len>_i;_i++)if(write=_ref[_i],action===write.action&&angular.equals(params,write.params))return write},ResourceWriteQueue.prototype.removeWrite=function(_arg){var action,entry,newQueue,params,_i,_len,_ref;for(action=_arg.action,params=_arg.params,newQueue=[],_ref=this.queue,_i=0,_len=_ref.length;_len>_i;_i++)entry=_ref[_i],action===entry.action&&angular.equals(params,entry.params)||newQueue.push(entry);return this.queue=newQueue,0===this.queue.length&&this.timeoutPromise&&(this.$timeout.cancel(this.timeoutPromise),delete this.timeoutPromise),this._update(),0===this.queue.length?resolveDeferred(this):void 0},ResourceWriteQueue.prototype.flush=function(done){var write,_i,_len,_ref,_results;for(angular.isFunction(done)&&this.promise.then(done),this._setFlushTimeout(),_ref=this.queue,_results=[],
_i=0,_len=_ref.length;_len>_i;_i++)write=_ref[_i],_results.push(this._processWrite(write));return _results},ResourceWriteQueue.prototype.processResource=function(params,done){var notDone,write,_i,_len,_ref,_results;for(notDone=!0,_ref=this._writesForResource(params),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)write=_ref[_i],_results.push(this._processWrite(write,function(_this){return function(){return notDone&&0===_this._writesForResource(params).length?(notDone=!1,done()):void 0}}(this)));return _results},ResourceWriteQueue.prototype._writesForResource=function(params){var write,_i,_len,_ref,_results;for(_ref=this.queue,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)write=_ref[_i],angular.equals(params,write.params)&&_results.push(write);return _results},ResourceWriteQueue.prototype._processWrite=function(write,done){var cacheEntries,onFailure,onSuccess,writeData;if(!write.busy)return write.busy=!0,angular.isArray(write.resourceParams)?(cacheEntries=write.resourceParams.map(function(_this){return function(resourceParams){return new ResourceCacheEntry(_this.CachedResource.$key,resourceParams).load()}}(this)),writeData=cacheEntries.map(function(cacheEntry){return cacheEntry.value})):(cacheEntries=[new ResourceCacheEntry(this.CachedResource.$key,write.resourceParams).load()],writeData=cacheEntries[0].value),onSuccess=function(_this){return function(value){var _ref;return _this.removeWrite(write),null!=(_ref=write.deferred)&&_ref.resolve(value),_this.logStatusOfRequest("succeeded",write.action,write.resourceParams,writeData),angular.isFunction(done)?done():void 0}}(this),onFailure=function(_this){return function(error){var _ref;return error&&error.status>=400&&error.status<500?(_this.removeWrite(write),$log.error(""+write.action+" to "+_this.CachedResource.$key+" failed with error "+error.status,{method:error.config.method,url:error.config.url,writeData:writeData})):(write.busy=!1,_this.logStatusOfRequest("failed with error "+angular.toJson(error)+"; still in queue",write.action,write.resourceParams,writeData)),null!=(_ref=write.deferred)?_ref.reject(error):void 0}}(this),this.CachedResource.$resource[write.action](write.params,writeData,onSuccess,onFailure).$promise.then(function(_this){return function(savedResources){var cacheEntry,resource,resourceInstance,_i,_len,_results;for(savedResources=angular.isArray(savedResources)?savedResources:[savedResources],_results=[],_i=0,_len=savedResources.length;_len>_i;_i++)resource=savedResources[_i],resourceInstance=new _this.CachedResource(resource),cacheEntry=new ResourceCacheEntry(_this.CachedResource.$key,resourceInstance.$params()).load(),_results.push(cacheEntry.set(resource,!1));return _results}}(this)),this.logStatusOfRequest("processed",write.action,write.resourceParams,writeData)},ResourceWriteQueue.prototype._setFlushTimeout=function(){return this.queue.length>0&&!this.timeoutPromise?(this.timeoutPromise=this.$timeout(angular.bind(this,this.flush),CACHE_RETRY_TIMEOUT),this.timeoutPromise.then(function(_this){return function(){return delete _this.timeoutPromise,_this._setFlushTimeout()}}(this))):void 0},ResourceWriteQueue.prototype._update=function(){var savableQueue;return savableQueue=this.queue.map(function(write){return{params:write.params,resourceParams:write.resourceParams,action:write.action}}),Cache.setItem(this.key,savableQueue)},ResourceWriteQueue}()}},{"./cache":2,"./resource_cache_entry":10}],12:[function(require,module,exports){var modifyObjectInPlace,writeCache;modifyObjectInPlace=require("./modify_object_in_place"),module.exports=writeCache=function($q,providerParams,action,CachedResource,actionConfig){var ResourceCacheEntry;return ResourceCacheEntry=require("./resource_cache_entry")(providerParams),function(){var args,cacheEntry,data,deferred,error,instanceMethod,isArray,isDirty,param,params,queueDeferred,resource,success,value,wrapInCachedResource,_i,_len,_ref;if(instanceMethod=this instanceof CachedResource,args=Array.prototype.slice.call(arguments),params=!instanceMethod&&angular.isObject(args[1])?args.shift():instanceMethod&&angular.isObject(args[0])?args.shift():{},data=instanceMethod?this:args.shift(),success=args[0],error=args[1],isArray=angular.isArray(data),isDirty=!actionConfig.cacheOnly,wrapInCachedResource=function(object){return object instanceof CachedResource?object:new CachedResource(object)},isArray)for(data=data.map(function(o){return wrapInCachedResource(o)}),_i=0,_len=data.length;_len>_i;_i++)resource=data[_i],cacheEntry=new ResourceCacheEntry(CachedResource.$key,resource.$params()).load(),angular.equals(cacheEntry.data,resource)||cacheEntry.set(resource,isDirty);else{data=wrapInCachedResource(data),_ref=data.$params();for(param in _ref)value=_ref[param],params[param]=value;cacheEntry=new ResourceCacheEntry(CachedResource.$key,data.$params()).load(),angular.equals(cacheEntry.data,data)||cacheEntry.set(data,isDirty)}return data.$resolved=!1,deferred=$q.defer(),data.$promise=deferred.promise,angular.isFunction(success)&&deferred.promise.then(success),angular.isFunction(error)&&deferred.promise["catch"](error),actionConfig.cacheOnly?(data.$resolved=!0,deferred.resolve(data)):(queueDeferred=$q.defer(),queueDeferred.promise.then(function(httpResource){return cacheEntry.load(),modifyObjectInPlace(data,httpResource,cacheEntry.value),data.$resolved=!0,deferred.resolve(data)}),queueDeferred.promise["catch"](deferred.reject),CachedResource.$writes.enqueue(params,data,action,queueDeferred),CachedResource.$writes.flush()),data}}},{"./modify_object_in_place":5,"./resource_cache_entry":10}]},{},[4]),function(angular){angular.module("npb",["ngCachedResource"])}(angular),function(angular){angular.module("npb").directive("actionCall",function(actions){return{restrict:"A",link:function($scope,$element,$attributes){var action,data;$element.on("click",function(event){action=$scope.$eval($attributes.actionCall),data=$scope.$eval($attributes.actionData)||{},data.$event=event,actions.call("action:"+action,data)})}}})}(angular),function(angular){angular.module("npb").directive("xfeInputsContainer",function($compile,inputSets,elementBuilder,$timeout){return{restrict:"E",replace:!0,templateUrl:"partials/elements/inputs_container.html",compile:function(){return{pre:function(scope,element,attr){var body,actionBody,inputs,id;id=scope.id,angular.forEach(element.find("form"),function(form){var $form=angular.element(form);$form.hasClass("inputs-container")&&(body=$form),body&&id&&(body.attr("id",id),body.attr("name",id))}),angular.forEach(element.find("div"),function(div){var $div=angular.element(div);$div.hasClass("actions-container")&&(actionBody=$div)});var build=function(){inputs=inputSets.getSet(scope.inputsSet),angular.forEach(inputs,function(inputDefinition){var elName,elementTemplate,element,nScope;elName=inputDefinition.element,elementTemplate='<div class="form-group">   <label class="control-label col-md-5">       {{ configuration.label }}   </label>   <div class="col-md-7">       %%   </div></div>',element=elementBuilder(elName,elementTemplate),nScope=scope.$new(),nScope.configuration=inputDefinition,$compile(element)(nScope),body.append(element)})};$timeout(function(){$timeout(build)}),scope.headerActions&&scope.headerActions.length&&angular.forEach(scope.headerActions,function(elementTemplate){var element=angular.element(elementTemplate);$compile(element)(scope),actionBody.append(element)})}}}}})}(angular),function(angular){angular.module("npb").directive("npbElementsContainer",function($compile,elementBuilder){function dispatchElement(def){return angular.isString(def)&&(def={element:def,options:{}}),def}return{replace:!0,restrict:"E",template:"<npb-container></npb-container>",compile:function(){return{pre:function(scope,element,attr){scope.$watchCollection(attr.configuration,function(n){element.html(""),n&&angular.forEach(n,function(def){var el,dispatched,nScope;dispatched=dispatchElement(def),el=elementBuilder(dispatched.element),nScope=scope.$new(),angular.extend(nScope,dispatched.options),$compile(el)(nScope),element.append(el)})})}}}}})}(angular),function(angular){angular.module("npb").constant("filtersState",{}).directive("npbFiltersContainer",function(dialog,filterDialogMapper,$compile,filtersState){return{replace:!1,restrict:"E",controller:function($scope){var openFilter,states=filtersState,filters={};$scope.$on("filter:clicked",function($event,filter,state){var id;id=filterDialogMapper.getIdByType(filter.type),openFilter=filter,dialog.open(id,filter.label,{filter:filter,state:state})}),$scope.$on("dialog:ok",function($event,options,result){options.filter&&openFilter&&openFilter.name===options.filter.name&&filters[openFilter.name].update(result)}),this.getConditions=function(){return states},this.getState=function(name){return states[name]?states[name]:null},this.setState=function(name,value){states[name]=value},this.bind=function(name,ctrl){filters[name]=ctrl},this.unbind=function(name){states[name]&&delete states[name],filters[name]&&delete filters[name]}},controllerAs:"fc",link:function($scope,$element){function makeFilter(definition){var element=angular.element(definition.element),nScope=$scope.$new();nScope.filter=definition,$compile(element)(nScope),$element.append(element)}$scope.$watchCollection("pc.filters",function(n){$element.html(),n&&angular.forEach(n,makeFilter)})}}})}(angular),function(angular){angular.module("npb").directive("npbFilterBoolean",function(){return{replace:!0,restrict:"E",require:"^npbFiltersContainer",templateUrl:"partials/ui/filter/boolean.html",controller:function($scope,currentFilters){function render(){null===state?$scope.displayValue="-":state?$scope.displayValue=trueLabel:$scope.displayValue=falseLabel}function serialize(value){return null===value?"n":value?"1":"0"}function deserialize(value){return 1===parseInt(value)?!0:0===parseInt(value)?!1:null}var name,filter,state,trueLabel,falseLabel;filter=$scope.filter,name=filter.name,trueLabel=filter.trueLabel||"True",falseLabel=filter.falseLabel||"False",$scope.fc.bind(name,this),this.toggle=function(){var n;n=null===state?!0:!0===state?!1:null,state=n,$scope.$apply(function(){$scope.fc.setState(name,serialize(state)),render()})},state=deserialize(currentFilters.filters[name]),$scope.fc.setState(name,currentFilters.filters[name]||null),render()},controllerAs:"fbc",link:function($scope,$element,$attributes,nbpFiltersController){var name;name=$scope.filter.name,$scope.$on("$destroy",function(){nbpFiltersController.unbind(name)}),$scope.filter.readonly||$element.on("click",function(){$scope.fbc.toggle()})}}})}(angular),function(angular){angular.module("npb").directive("npbFilterLike",function(){return{replace:!0,restrict:"E",require:"^npbFiltersContainer",templateUrl:"partials/ui/filter/like.html",controller:function($scope,Dictionary,currentFilters){var name,filter;filter=$scope.filter,name=filter.name,$scope.fc.bind(name,this),$scope.filterValue=currentFilters.filters[name]?currentFilters.filters[name]:null},controllerAs:"fbc",link:function($scope,$element,$attributes,npbFiltersController){var name;name=$scope.filter.name,$scope.$on("$destroy",function(){npbFiltersController.unbind(name)}),$scope.filter.readonly?$element.find("input").attr("readonly",!0):$scope.$watch("filterValue",function(n){var v=""===n?null:n;npbFiltersController.setState(name,v)})}}})}(angular),function(angular){angular.module("npb").directive("npbFilterSearch",function(){return{replace:!0,restrict:"E",require:"^npbFiltersContainer",templateUrl:"partials/ui/filter/filter.html",controller:function($scope,Dictionary,currentFilters){function _construct(){var stateValue;stateValue=currentFilters.filters[name],state=[],stateValue&&angular.forEach(stateValue,function(item){state.push(data.get({pid:item}))}),$scope.fc.bind(name,this),this.update(state)}var name,filter,data,state,single,displayProperty;filter=$scope.filter,displayProperty=filter.displayProperty,name=filter.name,data=Dictionary.get(filter.data),single=!filter.multi,this.open=function(){$scope.$emit("filter:clicked",filter,state)},this.update=function(selection){var i,value,display;state=selection,value=[],display=[];for(i in state)state.hasOwnProperty(i)&&(value.push(state[i].id),display.push(state[i][displayProperty]));$scope.fc.setState(name,value),this.displayValue=display.length?display.join(", "):"-"},_construct.call(this)},controllerAs:"fbc",link:function($scope,$element,$attributes,npbFiltersController){var name;name=$scope.filter.name,$scope.$on("$destroy",function(){npbFiltersController.unbind(name)}),$scope.filter.readonly||$element.bind("click",function(){$scope.fbc.open()})}}})}(angular),function(angular){angular.module("npb").directive("npbFilterSelect",function(){return{replace:!0,restrict:"E",require:"^npbFiltersContainer",templateUrl:"partials/ui/filter/select.html",controller:function($scope,Dictionary,currentFilters){function _in(id,array){return angular.isArray(array)&&_.contains(array,id)||array==id}function _construct(){var stateValue;stateValue=currentFilters.filters[name],state=new WeakSet,stateValue&&angular.forEach(data,function(item){_in(item.id,stateValue)&&state.add(item)}),$scope.fc.bind(name,this),this.update(state)}var name,filter,data,state,single,displayProperty;filter=$scope.filter,name=filter.name,data=Dictionary.get(filter.data),single=!filter.multi,displayProperty=filter.displayProperty,this.open=function(){$scope.$emit("filter:clicked",filter,state)},this.update=function(wSet){var i,value,display;state=wSet,value=[],display=[];for(i in data)if(wSet.has(data[i])){if(display.push(data[i][displayProperty]),single){value=data[i].id;break}value.push(data[i].id)}$scope.fc.setState(name,value),this.displayValue=display.length?display.join(", "):"-"},_construct.call(this)},controllerAs:"fbc",link:function($scope,$element,$attributes,npbFiltersController){var name;name=$scope.filter.name,$scope.$on("$destroy",function(){npbFiltersController.unbind(name)}),$scope.filter.readonly||$element.bind("click",function(){$scope.fbc.open()})}}})}(angular),function(angular){angular.module("npb").directive("searchEditorField",function(){return{replace:!0,restrict:"E",template:"<div >{{ displayValue }}</div>",link:function($scope,$element,attributes){},controllerAs:"inputCtrl",controller:function(){}}})}(angular),function(angular){angular.module("npb").directive("npbSelectInput",function(propertyRenderer,dialog,dictionaryWeakSet,weakSetDictionary){return{replace:!0,restrict:"E",template:"<p data-pseudo-input>{{ displayValue }}</p>",controller:function($scope){this.$valid},controllerAs:"npbSi",link:function(scope,element){function getDialogId(){return{search:"dictionary_searcher",select:"dictionary_chooser"}[type]}function getConfig(){return{data:dataSrc,name:model,mode:mode,multi:multi,displayProperty:prop}}function getState(){var value=scope.$eval("$parent.editor.data."+model);return"search"===type?value:dictionaryWeakSet(dataSrc,value)}function getTitle(){return"Set `"+scope.configuration.label+"` Value"}function handleOpen(){var did,options,state,title;did=getDialogId(),options=getConfig(),state=getState(),title=getTitle(),dialog.open(did,title,{filter:options,state:state})}function handleValue(value){var ret;return ret=value,multi||(ret=value[0]),ret}function valid(d){!required||required&&multi&&d.length||required&&!multi&&null!==d&&"object"==typeof d?scope.npbSi.$valid=!0:scope.npbSi.$valid=!1}var model,multi,prop,dataSrc,readonly,type,mode,switchMode,validators,settings,required;model=scope.configuration.model,multi=scope.configuration.multi,dataSrc=scope.configuration.data,prop=scope.configuration.displayProperty,readonly=scope.configuration.readonly,type=scope.configuration.type,mode=scope.configuration.selectionMode,switchMode=scope.configuration.switchMode,settings=scope.configuration.settings||{},validators=settings.validators||[],required=validators.indexOf("required")>-1,scope.$watch("$parent.editor.data."+model,function(n){if(valid(n),n&&(n.length||n.name)){var d=propertyRenderer(n,prop,multi);scope.displayValue=d}else scope.displayValue="-"}),scope.$on("dialog:ok",function($event,options,result){var val;options.filter&&model===options.filter.name&&(val=result instanceof WeakSet?weakSetDictionary(dataSrc,result):result,scope.$applyAsync(function(){scope.$parent.editor.data[model]=handleValue(val)}))}),!readonly&&dataSrc&&element.on("click",handleOpen)}}})}(angular),function(angular){angular.module("npb").directive("svgIcon",function(){const regexp=/^\@(.+)/;return{replace:!0,restrict:"E",template:function(tEelement,tAttributes){if(!tAttributes.src)throw new Error("Svg Icon Error! src argument must be specified");var icon=tAttributes.src;return regexp.test(icon)&&(icon="{{ iconId }}"),'<svg><use xlink:href="'+icon+'"></use></svg>'},link:function($scope,$element,$attributes){const rr=regexp.exec($attributes.src);if(rr){const iconPath=rr[1];$scope.$watch(iconPath,function(n){n&&($scope.iconId=n)})}}}})}(angular),function(angular){var buildValidators=function(validators){return validators?validators.join(" ")+" ":""};angular.module("npb").directive("npbTextInput",function($compile){return{replace:!0,restrict:"E",template:"<em></em>",compile:function(){return{pre:function(scope,element){var model,template,multiline,readonly,validators,validatorsTplChunk;model=scope.configuration.model,multiline=scope.configuration.multiline,readonly=scope.configuration.readonly,validators=scope.configuration.validators,validatorsTplChunk=buildValidators(validators),template=multiline?"<textarea "+validatorsTplChunk+'ng-model="$parent.editor.data.'+model+'"></textarea>':'<input type="text" '+validatorsTplChunk+'ng-model="$parent.editor.data.'+model+'" />';var newElement=angular.element(template);readonly&&newElement.attr("readonly",!0),$compile(newElement)(scope),element.replaceWith(newElement)}}}}})}(angular),function(angular){angular.module("npb").filter("name",function(){return function(object){return object&&object.name||"-"}}).filter("names",function(nameFilter){return function(arrayOfObjects){return arrayOfObjects.length?_.map(arrayOfObjects,function(item){return nameFilter(item)}).join(", "):"-"}}).filter("join",function(){return function(array){return array&&array.length>0&&array.join(", ")||"-"}})}(angular),function(angular){function ActionsHandler(actions,$injector,$rootScope){function getLocals($event,$payload,$action){return{$event:$event,$action:$action,$payload:$payload}}function _construct(){angular.forEach(actions,function(handlers,actionName){angular.forEach(handlers,function(handler){$rootScope.$on(actionName,function($event,payload){$injector.invoke(handler,handler,getLocals($event,payload,actionName))})})})}this.call=function(actionName,payload){$rootScope.$broadcast(actionName,payload)},_construct.call(this)}angular.module("npb").provider("actions",function(){var actions={};this.addHandler=function(actionName,handlerFn){return actions[actionName]||(actions[actionName]=[]),actions[actionName].push(handlerFn),this},this.$get=function($injector,$rootScope){return new ActionsHandler(actions,$injector,$rootScope)}})}(angular),function(angular){angular.module("npb").provider("columns",function(){function ColumnsHandler(){this.get=function(id,override){return"undefined"==typeof columns[id]?new Error("ColumnHandler Error! Column `"+id+"` does not exists!"):Object.assign({id:id},columnDefault,columns[id],override||{})},this.lazyGet=function(column){var id,override,isArray;return isArray=angular.isArray(column),override=isArray&&column[1]||{},id=isArray&&column[0]||column,this.get(id,override)}}var columns,self,columnDefault;self=this,columns={},columnDefault={header:null,property:null,sortable:!1,filter:null,on:null,resolver:null,visible:!0,hide_able:!0},this.add=function(id,definition){var newDef;if(id in columns)throw new Error("columnsProvider Conflict! Column `"+id+"` already exists!");newDef={},newDef[id]=definition,columns=Object.assign(newDef,columns)},this.addAll=function(defintions){angular.forEach(defintions,function(definition,id){self.add(id,definition)})},this.$get=function(){return new ColumnsHandler}})}(angular),function(angular){function buildTree(pref,container){var reg=new RegExp("^"+pref+":?([^:]+|@)$");angular.forEach(flat,function(item,key){var matches=reg.exec(key);matches&&(container.addMember(matches[1],item),buildTree(key,item))})}function buildKey(sectionName,contentName,contentPartName){function d(v){return v&&angular.isString(v)?":"+v:""}return sectionName+d(contentName)+d(contentPartName)}function ContentPageDefinition(config,objParent){function __constructor(config,objParent){objParent&&objParent instanceof ContentPageDefinition&&(parent=objParent,parent.addMember(this)),angular.extend(this,config)}var parent=null,members={};this["abstract"]=!1,this.status=200,this.title=null,this.contentLoader=null,this.columnSet=null,this.defaultClumnSet=null,this.filterSet=null,this.defaultFilterSet=null,this.editor=null,this.highlighter=null,this.aside=null,this.wildCardResolver=null,this.initialFilterValues={},this.contextMenu=null,this.pageMenu=null,this.getMembers=function(){return members},this.setParent=function(contentPageDefinition){contentPageDefinition&&contentPageDefinition instanceof ContentPageDefinition&&(parent=contentPageDefinition)},this.getParent=function(){return parent},this.addMember=function(memberName,objMember){objMember.setParent(this),members[memberName]=objMember},this.hasMember=function(memberName){return members[memberName]&&members[memberName]instanceof ContentPageDefinition},this.getMember=function(memberName){return members[memberName]||new ContentPageDefinition({status:404})},this.getContentLoader=function(){return this.contentLoader||(parent instanceof ContentPageDefinition?parent.getContentLoader():null)},this.getTitle=function(){return this.title||(parent instanceof ContentPageDefinition?parent.getTitle():null)},this.getColumnSet=function(){return this.columnSet||(parent instanceof ContentPageDefinition?parent.getColumnSet():null)},this.getDefaultColumnSet=function(){return this.defaultClumnSet||(parent instanceof ContentPageDefinition?parent.getDefaultColumnSet():null)},this.getFilterSet=function(){return this.filterSet||(parent instanceof ContentPageDefinition?parent.getFilterSet():null)},this.getDefaultFilterSet=function(){return this.defaultFilterSet||(parent instanceof ContentPageDefinition?parent.getDefaultFilterSet():null)},this.getInitialFilterValues=function(){return this.initialFilterValues||(parent instanceof ContentPageDefinition?parent.getInitialFilterValues():null)},this.getEditor=function(){return this.editor||(parent instanceof ContentPageDefinition?parent.getEditor():null)},this.getHighlighter=function(){return this.highlighter||(parent instanceof ContentPageDefinition?parent.getHighlighter():angular.noop)},this.getAside=function(){return this.aside||(parent instanceof ContentPageDefinition?parent.getAside():null)},this.getContextMenu=function(){return this.contextMenu||(parent instanceof ContentPageDefinition?parent.getContextMenu():null)},this.getPageMenu=function(){return this.pageMenu||(parent instanceof ContentPageDefinition?parent.getPageMenu():null)},__constructor.call(this,config,objParent)}function ContentPage(){this.findDefintion=function(sectionName,contentName,contentPartName){var definition=null,key=buildKey(sectionName,contentName,contentPartName);if(flat[key]&&flat[key]instanceof ContentPageDefinition)definition=flat[key];else{var wildCard=key.replace(/^(.+):([^:])+$/,"$1:@");definition=flat[wildCard]||null}return definition||{stats:404}}}var pageHierarchy,flat={};angular.module("npb").provider("contentPage",function(){function checkArguments(args){var l,i,n;if(l=args.length,2>l||l>4)throw new Error("ContentPageProvider Error. Wrong addPage method call. Expected at least 2 but max 4 args!","content_page_provider_args_num_out_of_range");if(!angular.isObject(args[l-1]))throw new Error("ContentPageProvider Error. Last argument must be a page definition object!","content_page_provider_last_arg");for(i=0;l-1>i;i++)if(args.hasOwnProperty(i)&&!angular.isString(args[i]))throw n=(i+1).toString(),new Error("ContentPageProvider Error. Wrong addPage method call. "+n+" argument must be a string","content_page_provider_page_identification")}pageHierarchy=new ContentPageDefinition,this.setBaseConfig=function(contentPageDefinitionConfig){pageHierarchy=new ContentPageDefinition(contentPageDefinitionConfig)},this.addPage=function(sectionName,contentName,contentPartName,config){function a(l){return l[l.length-1]}checkArguments(arguments);var key=buildKey(sectionName,contentName,contentPartName),conf=a(arguments);return flat[key]=new ContentPageDefinition(conf,null),this},this.$get=function(){return buildTree("",pageHierarchy),new ContentPage}})}(angular),function(angular){function Dialogs(){this.get=function(name){if(!configs[name])throw new Error("Dialogs Error! Dialog `"+name+"` doesn't exists!","dialog_does_not_exists");return configs[name]}}var configs={};angular.module("npb").provider("dialogs",function(){this.add=function(name,config){return"undefined"==typeof configs[name]&&(configs[name]=config),this},this.$get=function(){return new Dialogs}})}(angular),function(angular){function Dictionary($q,$injector){var data;data={},this.get=function(name){return data[name]},this.prefetch=function(){var promises;promises=[],angular.forEach(configs,function(definition,name){var service,hasEmbeddedData,resource;resource=definition.resource,hasEmbeddedData=angular.isArray(resource),hasEmbeddedData?data[name]=resource:definition.prefetch?(service=$injector.get(resource),data[name]=service.query(),promises.push(data[name].$promise)):data[name]=$injector.get(resource)}.bind(this))}}var configs={};angular.module("npb").provider("Dictionary",function(){this.add=function(name,config){return"undefined"==typeof configs[name]&&(configs[name]=config),this},this.$get=function($q,$injector){return new Dictionary($q,$injector)}})}(angular),function(angular){function InputConfig(config){function __construct(){angular.extend(this,defaults,config)}var defaults={type:"normal",label:null,readonly:!1,model:null,data:null,allowNew:!1,multi:!1,switchMode:!1,displayProperty:"name",multiline:!1,directive:null};__construct.call(this)}function InputsHolderProvider(){var inputConfigs={};this.add=function(name,config){if(inputConfigs[name]instanceof InputConfig)throw new Error("InputsProvider Error! Input : `"+name+"` already exists","inputs_provider_name_in_use");return inputConfigs[name]=new InputConfig(config),this},this.addAll=function(configsHash){var p;for(p in configsHash)configsHash.hasOwnProperty(p)&&this.add(p,configsHash[p]);return this},this.$get=function(){function InputsHolder(){}return InputsHolder.prototype={getDefinition:function(name,override){if(!(inputConfigs[name]instanceof InputConfig))throw new Error("InputsHolder Error! Input: `"+name+"` is not defined");return inputConfigs[name].extend(override||{})}},new InputsHolder}}var relationTypes={select:!0,search:!0};InputConfig.prototype={extend:function(config){var copy=new InputConfig(this);return angular.extend(copy,config)},get selectionMode(){var mode,flag;return this.type in relationTypes||(mode=null),flag=this.switchMode?!this.multi:this.multi,flag?"multi":"single"},get element(){var map={normal:"npb-text-input",search:"npb-select-input",select:"npb-select-input",extra:this.directive};return map[this.type]}},angular.module("npb").provider("inputs",InputsHolderProvider)}(angular),function(angular){function FilterDefinition(config){function __validate(){if(!this.name)throw new Error("FilterDefinition Error. Name in not defined!","filter_definition_name_not_defined");if(!this.type in filterTypes)throw new Error("FilterDefinition Error. filter type must be one of: `"+Object.keys(filterTypes).join(", ")+"`.","filter_definition_wrong_type")}angular.extend(this,filterDefaults,config||{}),__validate.call(this)}function FilterHandler(){}var filterTypes,filters,filterDefaults;filterTypes={like:{element:"<npb-filter-like />"},"boolean":{element:"<npb-filter-boolean />"},search:{element:"<npb-filter-search />"},select:{element:"<npb-filter-select />"}},filters={},filterDefaults={name:null,type:"like",nullable:!0,defaultValue:null,readonly:!1,multi:!1,displayProperty:"name"},FilterDefinition.prototype={get kbDriven(){return this.type in{like:1,sLike:1}},get element(){return filterTypes[this.type].element}},FilterHandler.prototype.get=function(name,override){var filter,filterOverride;if(!name)throw new Error("FilterHandler Error. Filter's name is required.","filter_handler_get_filter_name_is_required");if(!filters[name])throw new Error("FilterHandler Error. Fiter '"+name+"' is not defined.","filter_handler_get_filter_is_not_defined");return filter=filters[name],override&&angular.isObject(override)?(filterOverride=new FilterDefinition({name:1}),angular.extend(filterOverride,filter,override),filterOverride):filter},FilterHandler.prototype.resolve=function(entry){return angular.isString(entry)?this.get(entry):angular.isArray(entry)&&2===entry.length?this.get(entry[0],entry[1]):void 0},angular.module("npb").provider("filters",function(){this.setDefaults=function(config){angular.extend(filterDefaults,config)},this.add=function(name,config){return filters[name]=new FilterDefinition(config),this},this.addAll=function(filtersHash){var p;for(p in filtersHash)filtersHash.hasOwnProperty(p)&&(filtersHash[p]=new FilterDefinition(filtersHash[p]));return angular.extend(filters,filtersHash),this},this.$get=function(){return new FilterHandler}}).factory("currentFilters",function(){return{filters:{},update:function(value){this.filters=value}}})}(angular),function(angular){function inputsSetsFactory(inputs){function resolveInput(input){return angular.isObject(input)?inputs.getDefinition(input.name,input.setting):inputs.getDefinition(input,{})}function resolveSet(inputSet){var i,r;r=[];for(i in inputSet)inputSet.hasOwnProperty(i)&&r.push(resolveInput(inputSet[i]));return r}function InputSets(){}return InputSets.prototype.getSet=function(setName){if(angular.isString(setName)&&!inputSets[setName])throw new Error("InputSets Error! Set named `"+setName+"` doesn't exists!","input_sets_set_does_not_exists");if(angular.isString(setName)&&inputSets[setName])return resolveSet(inputSets[setName]);if(angular.isArray(setName))return resolveSet(setName);throw new Error("Cant handle input set")},new InputSets}function InputSetsProvider(){this.add=function(setName,inputSet){if(angular.isArray(inputSets[setName]))throw new Error("InputSetsProvider Error! Set named `"+setName+"` already exists","input_sets_provider_set_already_exists");inputSets[setName]=inputSet},this.$get=inputsSetsFactory}var inputSets;inputSets={},angular.module("npb").provider("inputSets",InputSetsProvider)}(angular),function(angular){angular.module("npb").provider("message",function(){function MessageHandler(){this.getRawMessage=function(tplId){var message;if("undefined"==typeof messages[tplId]?(console.warn("Message `%s` is not registered. You can customize this message instead of using fallback",tplId),message=findCallback(tplId)):message=messages[tplId],!message)throw new Error("Message `"+tplId+"` is not registered and dont match any fallback");return message},this.getMessage=function(tplId,content){var messageFormat=this.getRawMessage(tplId);return stringFormat(messageFormat,content)}}var messages={},fallback=[{test:/error|fail/i,message:"Error!"},{test:/success|successful|/i,message:"OK!"}],findCallback=function(id){for(var i in fallback)if(fallback.hasOwnProperty(i)&&fallback[i].test.test(id))return fallback[i].message};this.addMessage=function(msgId,msgFormat){messages[msgId]=msgFormat},this.addAll=function(messagesMap){angular.forEach(messagesMap,function(msgFormat,msgId){this.addMessage(msgId,msgFormat)}.bind(this))},this.setFallback=function(userFallback){fallback=userFallback},this.$get=function(){return new MessageHandler}})}(angular),
function(angular){function Message(notifier,level,text){this.level=level,this.read=!1,this.text=text,this.close=function(){notifier.messages.splice(notifier.messages.indexOf(this),1)}}function Task(notifier,text){this.text=text,this.level="progress",this.progress=null,this.onResolve=angular.noop,this.resolve=function(level,msg){this.level=level,this.onResolve(this),"error"===level?notifier.message(level,msg||text):notifier.notify(level,msg||text),notifier.tasks.splice(notifier.tasks.indexOf(this),1)},this.setProgress=function(progress){this.progress=progress}}function Notifier(notifyHandler){this.tasks=[],this.messages=[],this.notifyHandler=notifyHandler}Notifier.prototype={message:function(level,text){var message=new Message(this,level,text);return this.messages.unshift(message),message},task:function(text){var task=new Task(this,text);return this.tasks.unshift(task),task},notify:function(level,text){this.notifyHandler(level,text)}},angular.module("npb").provider("notifier",function(){var notifyHandler=angular.noop;this.registerNotifyHandler=function(handler){notifyHandler=handler},this.$get=function($injector){var notifyHandlerResolved=notifyHandler;return angular.isString(notifyHandler)&&(notifyHandlerResolved=$injector.get(notifyHandler)),new Notifier(notifyHandlerResolved)}})}(angular),function(angular){angular.module("npb").factory("dialog",function($rootScope,$q){function Dialog(){this.title=null,this.options=null,this.open=function(id,title,options){this.title=title,this.options=options,$rootScope.$broadcast("dialog:open",id,title,options)},this.ok=function(callback){var result=callback();$rootScope.$broadcast("dialog:ok",this.options,result),this.close()},this.close=function(){$rootScope.$broadcast("dialog:close")}}return new Dialog})}(angular),function(angular){function dictionaryWeakSetFactory(Dictionary){return function(dictionaryName,value){var dictionary,ws;return ws=new WeakSet,null===value||"undefined"==typeof value?ws:(dictionary=Dictionary.get(dictionaryName),angular.isArray(value)||(value=[value]),angular.forEach(value,function(vi){angular.forEach(dictionary,function(di){vi.id===di.id&&ws.add(di)})}),ws)}}function weakSetDictionaryFactory(Dictionary){return function(dictionaryName,ws){var dictionary,a;return dictionary=Dictionary.get(dictionaryName),a=[],angular.forEach(dictionary,function(item){ws.has(item)&&a.push(item)}),a}}angular.module("npb").factory("dictionaryWeakSet",dictionaryWeakSetFactory).factory("weakSetDictionary",weakSetDictionaryFactory)}(angular),function(angular){angular.module("npb").factory("elementBuilder",function(){return function(element,wrapper){var template;return template="<"+element+"></"+element+">",wrapper&&(template=wrapper.replace("%%",template)),angular.element(template)}})}(angular),function(angular){angular.module("npb").constant("filterTypeDialogIdMap",{select:"dictionary_chooser",search:"dictionary_searcher"}).factory("filterDialogMapper",function(filterTypeDialogIdMap){function FilterDialogMapper(){this.getIdByType=function(type){return filterTypeDialogIdMap[type]}}return new FilterDialogMapper})}(angular),function(angular){angular.module("npb").factory("keyboard",function(ObservableDecorator){function getNamedKey(code){var p;for(p in namedKeyMap)if(namedKeyMap.hasOwnProperty(p)&&namedKeyMap[p]===code)return p}function getBitSignature(event){var bitMap=0;return event.shiftKey&&(bitMap|=4),(event.ctrlKey||event.metaKey)&&(bitMap|=2),event.altKey&&(bitMap|=1),bitMap}function normalizeStroke(stroke){var r=/(SHIFT|CTRL|ALT)?\+?(SHIFT|CTRL|ALT)?\+?(SHIFT|CTRL|ALT)?\+?(LEFT|RIGHT|UP|DOWN|ENTER|ESC|BACKSPACE|SPACE|[A-Z])/;if(!r.test(stroke))throw new Error("Keyboard stroke syntax error. :"+stroke+" is not valid!");for(var matches=r.exec(stroke),bitMap=0,i=1;4>i;i++)matches[i]&&switchKeyMap[matches[i]]&&(bitMap|=switchKeyMap[matches[i]]);return bitMap+"_"+matches[4]}function KbDispatcher(){function dispatch(event){var bitSignature=getBitSignature(event),eventName=bitSignature+"_"+(getNamedKey(event.which)||String.fromCharCode(event.which));return self.__events[eventName]?(event.preventDefault(),event.stopPropagation(),self.triggerEvent(eventName),!1):void 0}var self=this;this.bindMap=function(map,context){angular.forEach(map,function(handler,keyStroke){var normalizedStroke=normalizeStroke(keyStroke);this.on(normalizedStroke,handler,context)}.bind(this))},this.unbindMap=function(map,context){angular.forEach(map,function(handler,keyStroke){var normalizedStroke=normalizeStroke(keyStroke);this.un(normalizedStroke,handler,context)}.bind(this))},window.addEventListener("keydown",dispatch,!1),ObservableDecorator.decorate(this)}var namedKeyMap={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,ESC:27,BACKSPACE:8,SPACE:32},switchKeyMap={SHIFT:4,CTRL:2,ALT:1};return new KbDispatcher})}(angular),function(angular){angular.module("npb").factory("$localStorage",function(){function LocalStorage(){}return LocalStorage.prototype={getItem:function(itemId,defaults){return null===localStorage.getItem(itemId)&&defaults&&this.setItem(itemId,defaults),JSON.parse(localStorage.getItem(itemId))},setItem:function(itemId,value){localStorage.setItem(itemId,JSON.stringify(value))},removeItem:function(itemId){localStorage.removeItem(itemId)}},new LocalStorage})}(angular),function(angular){function ObservableDecorator(){this.decorate=function(object){object.__proto__.__events={},object.__proto__.on=function(event,callback,context){this.__events[event]||(this.__events[event]=[]);var call={fn:callback,ctx:context};this.__events[event].push(call)},object.__proto__.un=function(event,callback,context){if(this.__events[event]){var calls=this.__events[event];for(var i in calls)calls.hasOwnProperty(i)&&angular.equals(calls[i].fn,callback)&&angular.equals(calls[i].ctx,context)&&calls.splice(i,1)}},object.__proto__.triggerEvent=function(){var call,eventName,args=[];for(var i in arguments)arguments.hasOwnProperty(i)&&args.push(arguments[i]);if(eventName=args.shift(),this.__events[eventName])for(var p in this.__events[eventName])this.__events[eventName].hasOwnProperty(p)&&(call=this.__events[eventName][p],call.ctx?call.fn.apply(call.ctx,args):call.fn.apply(this,args))}}}angular.module("npb").service("ObservableDecorator",ObservableDecorator)}(angular),function(angular){function UrlParameters(){this.parse=function(str){return JSON.parse(str)},this.stringify=function(obj){function __appear(value){var emptyArray;return emptyArray=angular.isArray(value)&&0===value.length,!(null===value||"undefined"==typeof value||emptyArray)}var params,i,p;params={},i=0;for(p in obj)obj.hasOwnProperty(p)&&__appear(obj[p])&&(i++,params[p]=obj[p]);return i?JSON.stringify(params):null}}angular.module("npb").service("urlParameters",UrlParameters)}(angular),function(angular){angular.module("npb").factory("propertyRenderer",function(){return function(obj,property,multi){var collection,i,a;a=[],collection=multi?obj:[obj];for(i in collection)collection.hasOwnProperty(i)&&a.push(collection[i][property]);return a.join(", ")}})}(angular),function(angular){angular.module("npb").factory("$dataResource",function($resource,$cachedResource,resourceUrlBuilder,resourceHandler,notifier,message){function queryActionFactory(contentRange){function n(d){return d}function persistServerState(data,headersGetter,status){if(206>=status)for(var p in data)data.hasOwnProperty(p)&&(data[p]=copyState(data[p]));return data}return{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,contentRange&&contentRange.response()||n,persistServerState],headers:function(){return contentRange?{Range:contentRange.bindRequest()}:{}}()}}}function copyState(data){data.$serverState={};for(var p in data)data.hasOwnProperty(p)&&(data.$serverState[p]=_.clone(data[p]));return data}function decorateWithNotifications(resourceName){function generateMessageId(action,status){return"resource:"+resourceName+":"+action+":"+status}function createInterceptor(method){return{response:function(httpResponse){var msgId=generateMessageId(method,"success"),msg=message.getMessage(msgId,httpResponse.data);return notifier.notify("success",msg),httpResponse},responseError:function(httpResponse){var msgId=generateMessageId(method,"error"),msg=message.getMessage(msgId,httpResponse.config.data);return notifier.message("error",msg),httpResponse}}}var decorated=Object.assign({},defaultActions);return decorated.save=Object.assign({},defaultActions.save),decorated.patch=Object.assign({},defaultActions.patch),decorated.save.interceptor=createInterceptor("create"),decorated.patch.interceptor=createInterceptor("update"),decorated}var defaultResponseTransform,defaultActions,rpcAction,defaultSettings;return defaultResponseTransform=[angular.fromJson,copyState],defaultActions={query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,function(data,headersGetter,status){if(206>=status)for(var p in data)data.hasOwnProperty(p)&&(data[p]=copyState(data[p]));return data}],headers:{}},get:{method:"GET",transformResponse:defaultResponseTransform},save:{method:"POST",transformResponse:defaultResponseTransform},update:{method:"PUT",transformResponse:defaultResponseTransform},patch:{method:"PATCH",transformResponse:defaultResponseTransform,transformRequest:[resourceHandler.stateDiff,angular.toJson]},remove:{method:"DELETE"}},rpcAction={callProcedure:{method:"POST",params:{pid:"rpc"}}},defaultSettings={paramDefaults:{pid:"@id"},hasRpc:!1,rpcConfig:{},url:null,actions:{}},function(resourcesName,settings,contentRange){var currentSettings,resourcesUrl,paramDefaults,currentActions,decoratedWithNotifier,rpcConf,currentQuery,newResource;return decoratedWithNotifier=decorateWithNotifications(resourcesName),currentSettings=angular.extend({},defaultSettings,settings||{}),resourcesUrl=currentSettings.url||resourceUrlBuilder(resourcesName),paramDefaults=currentSettings.paramDefaults,rpcConf=currentSettings.hasRpc?rpcAction:{},currentQuery=queryActionFactory(contentRange),currentActions=angular.extend({},decoratedWithNotifier,currentSettings.actions,currentQuery,rpcConf),newResource=currentSettings.cached?$cachedResource(resourcesName,resourcesUrl,paramDefaults,currentActions):$resource(resourcesUrl,paramDefaults,currentActions),newResource.$$resourceName=resourcesName,newResource}})}(angular),function(angular){angular.module("npb").service("resourceHandler",function(){function ResourceHandler(){}return ResourceHandler.prototype={persistState:function(resource){return resource.$serverState={},angular.forEach(resource,function(item,key){resource[key]=_.clone(item)}),resource},restoreState:function(resource){resource.$serverState||resource.$get(),angular.forEach(resource.$serverState,function(item,key){resource[key]=_.clone(item)})},stateDiff:function(resource){var p,dataToPatch;if(dataToPatch={},"undefined"==typeof resource.$serverState)return dataToPatch=resource;var serverState=resource.$serverState;for(p in serverState)serverState.hasOwnProperty(p)&&!angular.equals(resource[p],serverState[p])&&(dataToPatch[p]=resource[p]);for(p in resource)resource.hasOwnProperty(p)&&!serverState.hasOwnProperty(p)&&/^[^\$]/.test(p)&&(dataToPatch[p]=resource[p]);return dataToPatch}},new ResourceHandler})}(angular),function(angular){"use strict";function SortParam(name,direction){this.field=name,this.direction=direction||null,this.toggle=function(){this.direction="+"===this.direction?"-":"+"},this.toString=function(){return this.direction+this.field}}function Sorting(){this.fields=[],this.getSortParam=function(fieldName,direction){return this.findSortParam(fieldName)||new SortParam(fieldName,direction)},this.findSortParam=function(fieldName){var i;for(i in this.fields)if(this.fields.hasOwnProperty(i)&&this.fields[i].field===fieldName)return this.fields[i]},this.sort=function(fieldName,add){var sortParam,newParam;sortParam=this.getSortParam(fieldName),newParam=null===sortParam.direction,sortParam.toggle(),add?add&&newParam&&this.fields.push(sortParam):this.fields=[sortParam]},this.setup=function(sorts){this.fields=[];var fieldsArr=sorts.split(",");angular.forEach(fieldsArr,function(field){var fieldMatches=/^(\+|\-)?([\w+_\-]+)$/.exec(field);this.fields.push(this.getSortParam(fieldMatches[2],fieldMatches[1]))}.bind(this))},this.toString=function(){return this.fields.join(",")}}function resourceLoaderFactory($dataResourceNew){return function ResourceLoader(resourceName){function load(){var query,sortString=sorting.toString(),sortingPart={};return sortString.length&&(sortingPart.sort=sortString),query=angular.extend({},filters,sortingPart),self.data=resource.query(query),self.data}this.data=[];var filters={},sorting=new Sorting,self=this,contentRange=new ContentRange(resourceName),resource=$dataResourceNew(resourceName,null,contentRange);this.getInstance=function(){return new ResourceLoader(resourceName)},this.newEntity=function(){return new resource},this.nextPage=function(){contentRange.nextPage(),load()},this.prevPage=function(){contentRange.prevPage(),load()},this.goToPage=function(pageNo){contentRange.goToPage(pageNo)},this.setPageSize=function(pageSize){contentRange.setPageSize(pageSize)},this.applySort=function(field,add){return sorting.sort(field,add||!1),this},this.getSorting=function(){return sorting},this.applyFilters=function(newFilters){return filters=newFilters,this},this.load=function(){return load()},this.getPage=function(){return contentRange.page},this.getPages=function(){return contentRange.totalPages},this.getCollectionSize=function(){return contentRange.items},this.getPageSize=function(){},this.getPrevPage=function(){return contentRange.getPrevPage()},this.getNextPage=function(){return contentRange.getNextPage()}}}function ContentRange(resourceName,page,pageSize){function __construct(resourceName,page,pageSize){this.range=resourceName,page&&(this.page=page),pageSize&&(this.pageSize=pageSize),this.calculateRange()}var self=this;this.from=null,this.to=null,this.range=null,this.pageSize=50,this.page=1,this.totalPages=null,this.items=null,this.calculateRange=function(){this.from=this.pageSize*(this.page-1),this.to=this.pageSize*this.page-1},this.bindRequest=function(){return function(){return self.range+"="+self.from+"-"+self.to}},this.response=function(){return function(data,headers){var contentRangeString,pattern,result,respondedFrom,respondedTo,respondedItems;return contentRangeString=headers("content-range"),pattern=/^([a-z0-9\-\_]+)\s+(\d+)-(\d+)\/(\d+)$/i,result=pattern.exec(contentRangeString),result?(respondedFrom=parseInt(result[2]),respondedTo=parseInt(result[3]),respondedItems=parseInt(result[4]),self.items=respondedItems,self.totalPages=Math.floor(self.items/self.pageSize)+(self.items%self.pageSize?1:0)):(self.items=0,self.totalPages=0,self.page=0),data}},this.goToPage=function(page){this.page=page,this.calculateRange()},this.setPageSize=function(pageSize){this.page=1,this.pageSize=pageSize,this.calculateRange()},this.nextPage=function(){this.totalPages&&this.page<this.totalPages&&(this.page++,this.calculateRange())},this.getPrevPage=function(){return 1<this.page?this.page-1:void 0},this.getNextPage=function(){return this.totalPages&&this.page<this.totalPages?this.page+1:void 0},this.prevPage=function(){1>this.page&&(this.page--,this.calculateRange())},__construct.call(this,resourceName,page,pageSize)}angular.module("npb").factory("ResourceLoader",function($dataResource){return resourceLoaderFactory($dataResource)})}(angular),function(angular){angular.module("npb").factory("api_url",function(frontend_conf){return window.url(frontend_conf.xite_cms_api)}).factory("resourceUrlBuilder",function(api_url){return function(resourceName){var normalizedName;return normalizedName=resourceName.replace(/\_/,"-"),api_url+"/"+normalizedName+"/:pid"}})}(angular),function(angular){angular.module("npb").factory("rpcClient",function($injector,notifier,message){function generateMessageId(resourceName,procedureName,status){return stringFormat("rpc:{resourceName}:{procedureName}:{status}",{resourceName:resourceName,procedureName:procedureName,status:status})}return function(resourceName){var resource;if(!$injector.has(resourceName))throw new Error("RPC Client! Cannot find "+resourceName+" end point");return resource=$injector.get(resourceName),function(procedure){return function(payload){var startMsgId=generateMessageId(resourceName,procedure,"start"),startMsg=message.getMessage(startMsgId,payload),rpcTask=notifier.task(startMsg),procedureResponse=resource.callProcedure({},{procedure:procedure,payload:payload});return procedureResponse.$promise.then(function(){var msgId=generateMessageId(resourceName,procedure,"success"),msg=message.getMessage(msgId,payload);rpcTask.resolve("success",msg)},function(reason){var msgId=generateMessageId(resourceName,procedure,"error"),msg=message.getMessage(msgId,payload);rpcTask.resolve("error",msg)}),procedureResponse}}}})}(angular),function(angular){angular.module("npb").factory("TableColumnDefinition",function(){function TableColumnDefinition(config){this.id=null,this.header=null,this.sortable=!1,this.hideable=!0,this.property=null,this.visible=!0,angular.extend(this,config)}return TableColumnDefinition}).factory("TableColumnSet",function(TableColumnDefinition,columns){function TableColumnSet(config){var self=this;this.columns=[],angular.forEach(config,function(requestedColumn){var id,override;override=angular.isArray(requestedColumn)&&requestedColumn[1]||{},id=angular.isArray(requestedColumn)&&requestedColumn[0]||requestedColumn,self.columns.push(columns.get(id,override))}),this.serialize=function(){return _.map(this.columns,function(col){return{id:col.id,v:col.visible}})},this.restore=function(serialized){_.each(serialized,function(item){_.find(this.columns,function(column){return column.id===item.id}).visible=item.v}.bind(this))}}return TableColumnSet}).factory("tableState",function($localStorage){function TableState(){function getColumnsStoragePath(stateId){return stateId+":columns"}var defaultColumnSet;this.currentId=null,this.columnSet=null,this.loader=null,this.highlighter=angular.noop,this.contextMenu=null,this.restore=function(id,columnSet,loader,highlighter,contextMenuName){this.currentId=id;var columnsPath=getColumnsStoragePath(this.currentId);defaultColumnSet=columnSet.serialize(),columnSet.restore($localStorage.getItem(columnsPath,defaultColumnSet)),this.columnSet=columnSet,this.loader=loader,this.highlighter=highlighter,this.contextMenu=contextMenuName},this.persistColumnSet=function(){var columnsPath=getColumnsStoragePath(this.currentId);$localStorage.setItem(columnsPath,this.columnSet.serialize())},this.restoreColumnSet=function(){var columnsPath=getColumnsStoragePath(this.currentId);$localStorage.setItem(columnsPath,defaultColumnSet),this.columnSet.restore(defaultColumnSet)}}return new TableState})}(angular),angular.module("npb").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("partials/elements/inputs_container.html",'<div class="editor-module">\n    <div class="header">\n        <div class="title">{{ title }}</div>\n        <div class="actions-container"></div>\n    </div>\n    <form class="body inputs-container">\n\n    </form>\n</div>'),$templateCache.put("partials/ui/filter/boolean.html",'<div class="filter">\n    <div class="label">{{ filter.label }}</div>\n    <div class="input">{{ displayValue }}</div>\n</div>'),$templateCache.put("partials/ui/filter/filter.html",'<div class="filter">\n    <div class="label">{{ filter.label }}</div>\n    <div ng-if="!filter.kbDriven" class="input">{{ fbc.displayValue }}</div>\n    <input ng-if="filter.kbDriven" class="input" ng-model="$parent.filterValue" />\n</div>'),$templateCache.put("partials/ui/filter/like.html",'<div class="filter">\n    <div class="label">{{ filter.label }}</div>\n    <input class="input" ng-model="filterValue" />\n</div>'),$templateCache.put("partials/ui/filter/select.html",'<div class="filter">\n    <div class="label">{{ filter.label }}</div>\n    <div class="input">{{ fbc.displayValue }}</div>\n</div>')}]);